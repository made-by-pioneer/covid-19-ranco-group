{{ define "main" }}

<style>

</style>

<div class="flex flex-wrap w-11/12 sm:w-2/3 lg:w-1/3 mx-auto sm:text-center pb-32">
    <h1 class="w-full font-neue text-3xl font-medium pb-5 leading-tight">COVID19 Pandemic <br> Supplies In One Place</h1>
    <p class="w-full font-neue text-base">Weâ€™re providing pandemic supplies and protective equipment for city governments, municipalities, state departments, and emergency management personnel to help you combat COVID19.</p>
</div>

<div class="flex flex-wrap w-full lg:w-3/4 xxl:w-2/3 mx-auto">
{{ range where .Site.Pages "Type" "products" }}
<div class="flex flex-wrap w-full sm:w-2/3 md:w-1/2 xl:w-1/3 mx-auto p-4 product-seperater">
    <div id="product" class="flex flex-wrap w-full border border-black">
        <div class="flex flex-wrap w-full mx-auto text-center">
            <img class="w-56 mx-auto p-6" src="{{ .Site.Params.tracking.cloudinary_url }}{{ .Params.image }}">
            <div class="flex flex-wrap bg-color-F7F7F7 p-8">
                <h2 id="title" class="w-full font-neue text-base font-medium">{{ .Params.name }}</h2>
                <p id="des" class="w-full font-robo text-2xs pt-2 pb-6">{{ .Params.description }}</p>
                <div class="flex flex-wrap items-center w-full">
                    {{ if .Params.sizes }}
                        {{ if not (in .Params.sizes "N/A")}}
                        <div class="w-1/2 text-2xs">
                            <span class="font-neue tracking-widest uppercase">Size</span>
                            <select id="size" class="bg-white border border-black font-neue p-2 m-4">
                                    {{ range .Params.sizes }}
                                    <option value="{{ . }}" class="">{{ . }}</option>
                                    {{ end }}
                            </select>
                        </div>
                        {{ else }}
                        <div class="hidden">
                            <select id="size">
                                    <option value="N/A">N/A</option>
                            </select>
                        </div>
                        {{ end }}
                    {{ else }}{{ end }}
                    <div class="w-1/2 mx-auto text-2xs">
                        <span class="font-neue tracking-widest uppercase">QTY</span>
                        <input id="quantity" name="quantity" type="number" min="1" value="1" class="w-12 bg-white border border-black font-neue p-2 m-4">
                    </div>
                </div>
                <button id="quote-button" class="w-auto bg-white border border-black font-neue uppercase mt-5 mx-auto py-1 px-5">Add to Quote</button>
            </div>
            <script>
                {{ .Params.name | urlize | replaceRE "-" "" | safeJS }}removeQuote = () => {
                    const product = quoteQuans.find( ({ productName }) => productName === "{{ .Params.name }}" );
                    var getQuoteForm = document.getElementById("{{ .Params.name }}-quote");
                    var getVisualQuote = document.getElementById("{{ .Params.name }}-quote-visual");
                    product.quanNeeded = 0
                    getQuoteForm.innerHTML = ''
                    getVisualQuote.innerHTML = ''
                }
            </script>
        </div>
    </div>
</div>
{{ end }}
</div>

<div class="flex flex-wrap w-11/12 md:w-5/6 lg:w-2/3 xl:w-1/2 mx-auto pt-20">
    <h3 class="w-full font-neue text-4xl font-medium text-center pb-12">My Quote</h3>
    <div class="hidden sm:flex flex-wrap w-full border-b border-black">
        <div class="w-1/4 font-robo text-2xs uppercase tracking-widest text-center pb-3">
            QTY
        </div>
        <div class="w-1/2 font-robo text-2xs uppercase tracking-widest">
            Product Description
        </div>
        <div class="w-1/4 font-robo text-2xs uppercase tracking-widest text-center">
            Remove
        </div>
    </div>
    <div id="visual" class="flex flex-wrap w-full">
    {{ range where .Site.Pages "Type" "products" }}
        <div id="{{ .Params.name }}-quote-visual" class="flex flex-wrap w-full single">
            
        </div>
    {{ end }}
    </div>
</div>

<form id="quote-form" class="flex flex-wrap w-11/12 md:w-5/6 lg:w-2/3 xl:w-1/2 mx-auto" action="/thank-you/" netlify-honeypot="field-for-coolguys" name="quote-form" method="POST" netlify>
    <input type="hidden" name="subject" value="Quote Request" />
    <div class="flex flex-wrap w-full mx-auto pt-3 font-robo text-2xs font-hairline italic">
        <div class="w-full sm:w-1/2 text-left p-2">
            Disclaimer: Pictures are representative of the product. Product may differ from the picture.
        </div>
        <div class="flex flex-wrap w-full sm:w-1/2 text-left p-2">
            <input type="checkbox" class="w-1/12 h-4" required>
            <span class="w-11/12">I certify that the above order is correct and that I agree with any disclaimers.</span>
        </div>
    </div>
    <h3 class="w-full font-neue text-4xl font-medium text-center pt-24 pb-12">Shipping Info</h3>
    {{ range where .Site.Pages "Type" "products" }}
        <div id="{{ .Params.name }}-quote"></div>
    {{ end }}
    <input type="text" name="field-for-coolguys" style="display:none" />
    <div class="flex flex-wrap w-full md:w-1/3 pb-2 md:pr-6">
        <label class="w-full text-2xs font-neue tracking-widest uppercase pb-2">Name*</label>
        <input name="full-name" type="text" placeholder="Full name" class="w-full font-neue text-xs border border-black py-2 px-3" required>
    </div>
    <div class="flex flex-wrap w-full md:w-1/3 pb-2 md:pr-6">
        <label class="w-full text-2xs font-neue tracking-widest uppercase pb-2">Phone*</label>
        <input name="phone-number" type="tel" placeholder="Phone Number" class="w-full font-neue text-xs border border-black py-2 px-3" required>
    </div>
    <div class="flex flex-wrap w-full md:w-1/3 pb-2 md:pr-6">
        <label class="w-full text-2xs font-neue tracking-widest uppercase pb-2">Email*</label>
        <input name="email" type="email" placeholder="Email Address" class="w-full font-neue text-xs border border-black py-2 px-3" required>
    </div>
    <div class="w-full py-2"></div>
    <div class="flex flex-wrap w-full md:w-1/2 pb-2 md:pr-6">
        <label class="w-full text-2xs font-neue tracking-widest uppercase pb-2">Shipping Address*</label>
        <input name="street-address" type="text" placeholder="Street Name and Number" class="w-full font-neue text-xs border border-black py-2 px-3" required>
    </div>
    <div class="flex flex-wrap w-full md:w-1/4 pb-2 md:pr-6">
        <label class="w-full text-2xs font-neue tracking-widest uppercase pb-2">State*</label>
        <input name="state" type="text" placeholder="State" class="w-full font-neue text-xs border border-black py-2 px-3" required>
    </div>
    <div class="flex flex-wrap w-full md:w-1/4 pb-2 md:pr-6">
        <label class="w-full text-2xs font-neue tracking-widest uppercase pb-2">Zip*</label>
        <input name="zip" type="text" placeholder="Zip Code" class="w-full font-neue text-xs border border-black py-2 px-3" required>
    </div>
    <div class="w-full py-2"></div>
    <div class="flex flex-wrap w-full pb-2 md:pr-6">
        <label class="w-full text-2xs font-neue tracking-widest uppercase pb-2">Details / Notes</label>
        <textarea name="shipping-details" type="text" placeholder="Any shipping details" class="w-full h-32 font-neue text-xs border border-black py-2 px-3" required></textarea>
    </div>
    <div class="w-full text-center">
        <input type="submit" value="Submit Quote" class="w-auto bg-white border border-black font-neue uppercase mt-5 mx-auto py-1 px-5 hover:cursor-pointer">
    </div>
</form>

<script>
const quoteQuans = [
{{ range where .Site.Pages "Type" "products" }}
{
  productName: "{{ .Params.name }}",
  quanNeeded: ""
  {{ if .Params.sizes }}
  ,sizeNeeded: ""
  {{ else }}{{ end }}
},
{{ end }}
];
</script>

<script>
let products = document.querySelectorAll("#product");

for (let i = 0; i < products.length; i++) {
    let productHtml = product[i];
    let productUpdate = productHtml.querySelector("button");
    productUpdate.addEventListener('click', function() { 
        let productHtmlName = productHtml.querySelector("#title").innerText;
        let getQuoteForm = document.getElementById(productHtmlName + "-quote");
        let getVisualQuote = document.getElementById(productHtmlName + "-quote-visual");
        let productArrayID = quoteQuans.find( ({ productName }) => productName === productHtmlName );
        let productDes = productHtml.querySelector("#des").innerText;
        let productQuan = productHtml.querySelector("#quantity").value;
        let productSize = productHtml.querySelector("#size").value;
    if (productArrayID.sizeNeeded !== productSize || productArrayID.quanNeeded !== productQuan) {
        productArrayID.quanNeeded = productQuan
        productArrayID.sizeNeeded = productSize
        getQuoteForm.innerHTML = '<input type="hidden" name="' + productHtmlName.split(" ").join("-").toLowerCase().replace(/[&\/\\#,+()$~%.'":*?<>{}]/g, '') + '-needed" value="' + productQuan + '"><input type="hidden" name="' + productHtmlName.split(" ").join("-").toLowerCase().replace(/[&\/\\#,+()$~%.'":*?<>{}]/g, '') + '-size" value="' + productSize + '">'
        getVisualQuote.innerHTML = '<div class="flex flex-wrap w-full py-5 border-b border-black"><div class="w-1/4 text-center"><span class="border border-black py-1 px-3">' + productQuan + '</span></div><div class="w-1/2 font-neue">' + productHtmlName + '<br><p class="pt-2 font-robo text-2xs">' + productDes + '</p></div><div class="w-1/4 text-center"><button class="border border-black py-1 px-3" onclick="' + productHtmlName.split(" ").join("-").split("-").join("").toLowerCase().replace(/[&\/\\#,+()$~%.'":*?<>{}]/g, '') + 'removeQuote()">X</button></div></div>'
    }
        
    }, false);
}
</script>

{{ end }}